<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Log Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar navbar-dark bg-dark mb-4">
  <div class="container-fluid">
    <div class="d-flex justify-content-between align-items-center">
      <span class="navbar-brand mb-0 h1">Log Dashboard</span>
      <ul class="navbar-nav flex-row gap-3">
        <li class="nav-item"><a href="{{ url_for('logs_page') }}" class="nav-link {% if menu=='logs' %}active text-white{% else %}text-secondary{% endif %}">Logs</a></li>
        <li class="nav-item"><a href="{{ url_for('analyzed_page') }}" class="nav-link {% if menu=='analyzed' %}active text-white{% else %}text-secondary{% endif %}">Analisados</a></li>
      </ul>
    </div>
    <div id="toolbar" class="d-flex flex-wrap gap-3 small mt-2">
      <span id="severity-info"></span>
      <span id="attack-info"></span>
      <span id="iface-info" class="text-light"></span>
    </div>
  </div>
</nav>
<div class="container my-4">
{% block content %}{% endblock %}
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
const SEVERITY_COLORS = {{ severity_colors | tojson }};
async function fetchStats() {
  const resp = await fetch('/api/stats');
  if (!resp.ok) return;
  const data = await resp.json();
  const sev = document.getElementById('severity-info');
  const attacks = document.getElementById('attack-info');
  const iface = document.getElementById('iface-info');
  sev.innerHTML = Object.entries(data.severity).map(
    ([k,v]) => `<span class="${SEVERITY_COLORS[k] || ''} me-2">${k}: ${v}</span>`
  ).join(' ');
  attacks.textContent = Object.entries(data.attacks).map(
    ([k,v]) => `${k}: ${v}`
  ).join(' ');
  iface.textContent = `Ativas: ${data.interfaces.active.join(', ')} | Atividade: ${data.interfaces.activity.join(', ')}`;
}
fetchStats();
setInterval(fetchStats, 5000);
</script>
</body>
</html>
